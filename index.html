<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlowGuide AI - Professional Skin Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #2c3e50;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        .tagline {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        .camera-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        .section-title {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
        }
        .camera-container {
            position: relative;
            display: inline-block;
            margin: 20px 0;
        }
        #webcam-video {
            border: 3px solid #e9ecef;
            border-radius: 15px;
            background: #f8f9fa;
            width: 450px;
            height: 337px;
            object-fit: cover;
            transform: scaleX(-1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .camera-placeholder {
            width: 450px;
            height: 337px;
            border: 3px dashed #bdc3c7;
            border-radius: 15px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 160px;
            justify-content: center;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        .btn-secondary {
            background: #27ae60;
            color: white;
        }
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .analysis-display {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .results-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .skin-type-badge {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50px;
            font-size: 1.3em;
            font-weight: 600;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .confidence-meter {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #27ae60;
        }
        .routine-step {
            background: #f8f9fa;
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            border-left: 5px solid #3498db;
            transition: transform 0.2s ease;
        }
        .routine-step:hover {
            transform: translateX(5px);
        }
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .step-number {
            background: #3498db;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 15px;
        }
        .product-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border: 1px solid #e9ecef;
        }
        .product-name {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 600;
        }
        .ingredient-tag {
            display: inline-block;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            margin: 5px 5px 5px 0;
            font-weight: 500;
        }
        .priority-badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-left: 10px;
        }
        .priority-high { background: #e74c3c; color: white; }
        .priority-medium { background: #f39c12; color: white; }
        .priority-low { background: #27ae60; color: white; }
        .loading-indicator {
            text-align: center;
            padding: 30px;
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        .hidden {
            display: none;
        }
        .tab-container {
            display: flex;
            margin: 25px 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 5px;
        }
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .tab.active {
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #667eea;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .disclaimer {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            margin-top: 30px;
            font-size: 0.9em;
            color: #7f8c8d;
            text-align: center;
            border-left: 4px solid #e74c3c;
        }
        .success-banner {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        .demo-mode {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .header {
                padding: 25px;
            }
            h1 {
                font-size: 2.2em;
            }
            #webcam-video, .camera-placeholder {
                width: 100%;
                height: 300px;
            }
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>GlowGuide AI</h1>
            <p class="tagline">Professional Skin Analysis & Personalized Care</p>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üß†</div>
                    <h3>AI Powered</h3>
                    <p>Advanced skin analysis</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíé</div>
                    <h3>Personalized</h3>
                    <p>Custom routines for your skin</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3>Instant Results</h3>
                    <p>Real-time recommendations</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>100% Private</h3>
                    <p>Your data never leaves</p>
                </div>
            </div>
        </div>

        <!-- Camera Section -->
        <div class="camera-section">
            <h2 class="section-title">Skin Analysis</h2>
            
            <div class="demo-mode">
                <strong>Demo Mode Active</strong> - Using simulated AI analysis to show full results
            </div>

            <div class="camera-container">
                <div id="camera-placeholder" class="camera-placeholder">
                    <div>
                        <div style="font-size: 3em; margin-bottom: 10px;">üì∑</div>
                        <p>Camera ready for analysis</p>
                    </div>
                </div>
                <video id="webcam-video" class="hidden" autoplay playsinline></video>
            </div>

            <div class="analysis-display" id="prediction-display">
                <p style="text-align: center; color: #7f8c8d; margin: 0;">
                    Start camera to begin skin analysis
                </p>
            </div>

            <div class="control-buttons">
                <button onclick="startCamera()" id="startBtn" class="btn btn-primary">
                    <span>üé•</span> Start Camera
                </button>
                <button onclick="stopCamera()" id="stopBtn" class="btn btn-danger hidden">
                    <span>‚èπÔ∏è</span> Stop Camera
                </button>
                <button onclick="analyzeSkin()" id="analyzeBtn" class="btn btn-secondary" disabled>
                    <span>üîç</span> Analyze Skin
                </button>
                <button onclick="showDemoResults()" class="btn btn-primary">
                    <span>üöÄ</span> Show Demo Results
                </button>
            </div>

            <div class="loading-indicator" id="loading"></div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="results-section hidden">
            <div class="success-banner">
                <h2 style="margin: 0; font-size: 1.5em;">‚úÖ Analysis Complete!</h2>
                <p style="margin: 10px 0 0 0; opacity: 0.9;">Your personalized skincare report is ready</p>
            </div>

            <div id="result"></div>
            
            <div class="tab-container">
                <div class="tab active" onclick="switchTab('routine')">Daily Routine</div>
                <div class="tab" onclick="switchTab('products')">Product List</div>
                <div class="tab" onclick="switchTab('tips')">Expert Tips</div>
            </div>

            <div id="routine-tab" class="tab-content active">
                <div id="recommendations"></div>
            </div>
            
            <div id="products-tab" class="tab-content">
                <div id="product-list"></div>
            </div>
            
            <div id="tips-tab" class="tab-content">
                <div id="expert-tips"></div>
            </div>

            <div class="control-buttons" style="margin-top: 30px;">
                <button onclick="shareApp()" class="btn btn-primary">
                    <span>üì§</span> Share Results
                </button>
                <button onclick="startNewAnalysis()" class="btn btn-secondary">
                    <span>üîÑ</span> New Analysis
                </button>
            </div>
        </div>

        <div class="disclaimer">
            <strong>Disclaimer:</strong> This AI provides cosmetic recommendations only. Not medical advice. 
            Consult a dermatologist for serious concerns. We don't store your images or personal data.
        </div>
    </div>

    <script>
        // Global variables
        let model;
        let webcam;
        let isCameraOn = false;
        let isAnalyzing = false;
        let analysisInterval;
        let currentSkinType = '';

        // Skin analysis database - COMPLETE AND WORKING
        const skinConditions = {
            'Acne-Prone Skin': {
                description: 'Active breakouts, inflammation, and congestion detected. Focus on clearing current acne while preventing future breakouts.',
                primaryConcerns: ['Active breakouts', 'Inflammation', 'Excess oil', 'Clogged pores', 'Redness'],
                severityLevel: 'High Priority',
                morningRoutine: [
                    {
                        step: 1,
                        product: 'CeraVe SA Renewing Cleanser',
                        type: 'Cleanser',
                        ingredients: ['Salicylic Acid 0.5%', 'Niacinamide', 'Ceramides'],
                        purpose: 'Deep clean pores and reduce inflammation',
                        application: 'Massage onto damp skin for 60 seconds, then rinse thoroughly with lukewarm water',
                        priority: 'high',
                        timing: 'Daily in morning'
                    },
                    {
                        step: 2,
                        product: 'The Ordinary Niacinamide 10% + Zinc 1%',
                        type: 'Treatment Serum',
                        ingredients: ['Niacinamide 10%', 'Zinc PCA 1%'],
                        purpose: 'Control oil production and reduce redness',
                        application: 'Apply 3-4 drops to entire face, let absorb completely for 2 minutes before next step',
                        priority: 'high',
                        timing: 'Daily after cleansing'
                    },
                    {
                        step: 3,
                        product: 'La Roche-Posay Effaclar Duo+',
                        type: 'Treatment Cream',
                        ingredients: ['Salicylic Acid', 'LHA', 'Niacinamide'],
                        purpose: 'Target active breakouts and prevent new ones',
                        application: 'Apply thin layer to affected areas only, avoid eye area',
                        priority: 'high',
                        timing: 'Daily after serum'
                    },
                    {
                        step: 4,
                        product: 'Neutrogena Oil-Free Moisture with SPF 35',
                        type: 'Moisturizer + SPF',
                        ingredients: ['SPF 35', 'Glycerin', 'Dimethicone'],
                        purpose: 'Hydrate without clogging pores + essential sun protection',
                        application: 'Apply evenly to face and neck, reapply every 2 hours if in sun',
                        priority: 'high',
                        timing: 'Final morning step'
                    }
                ],
                eveningRoutine: [
                    {
                        step: 1,
                        product: 'CeraVe Foaming Facial Cleanser',
                        type: 'Cleanser',
                        ingredients: ['Ceramides', 'Hyaluronic Acid', 'Niacinamide'],
                        purpose: 'Remove makeup, oil, and daily impurities',
                        application: 'Double cleanse if wearing makeup/sunscreen - massage for 60 seconds',
                        priority: 'high',
                        timing: 'Nightly first step'
                    },
                    {
                        step: 2,
                        product: 'Paula\'s Choice 2% BHA Liquid Exfoliant',
                        type: 'Exfoliant',
                        ingredients: ['Salicylic Acid 2%', 'Green Tea Extract'],
                        purpose: 'Unclog pores and smooth texture',
                        application: 'Apply with cotton pad 3x weekly (Mon, Wed, Fri), avoid daily use',
                        priority: 'medium',
                        timing: '3x weekly after cleansing'
                    },
                    {
                        step: 3,
                        product: 'The Ordinary Azelaic Acid Suspension 10%',
                        type: 'Treatment',
                        ingredients: ['Azelaic Acid 10%'],
                        purpose: 'Reduce redness and post-acne marks',
                        application: 'Apply pea-sized amount to entire face, focus on red areas',
                        priority: 'medium',
                        timing: 'Nightly on non-exfoliation days'
                    },
                    {
                        step: 4,
                        product: 'La Roche-Posay Cicaplast Baume B5',
                        type: 'Repair Balm',
                        ingredients: ['Panthenol', 'Madecassoside', 'Shea Butter'],
                        purpose: 'Repair skin barrier and reduce irritation from treatments',
                        application: 'Apply as final step on irritated or dry areas only',
                        priority: 'low',
                        timing: 'As needed at night'
                    }
                ],
                weeklyTreatments: [
                    {
                        product: 'The Ordinary AHA 30% + BHA 2% Peeling Solution',
                        frequency: 'Once weekly (Sunday)',
                        purpose: 'Deep exfoliation and pore purification',
                        application: 'Apply for maximum 10 minutes, then rinse thoroughly',
                        warning: 'Do not use on active inflamed acne or sensitive skin'
                    }
                ],
                keyIngredients: ['Salicylic Acid', 'Niacinamide', 'Azelaic Acid', 'Zinc', 'Ceramides'],
                avoidIngredients: ['Heavy oils', 'Comedogenic ingredients', 'Fragrance', 'Alcohol'],
                expertTips: [
                    'Use non-comedogenic products only - check labels for "oil-free" and "non-comedogenic"',
                    'Change pillowcases 2-3 times per week to prevent bacteria buildup',
                    'Avoid touching your face throughout the day to prevent spreading bacteria',
                    'Be patient - significant improvement takes 4-8 weeks of consistent use',
                    'Spot treat individual pimples with benzoyl peroxide 2.5% for faster results',
                    'Always remove makeup completely before bed to prevent clogged pores'
                ],
                expectedResults: 'Visible reduction in breakouts within 2-4 weeks, significantly clearer skin in 6-8 weeks with consistent use'
            },

            'Dry Skin': {
                description: 'Significant dehydration and compromised skin barrier detected. Focus on intensive hydration and barrier repair.',
                primaryConcerns: ['Dehydration', 'Flakiness', 'Tightness', 'Barrier damage', 'Rough texture'],
                severityLevel: 'High Priority',
                morningRoutine: [
                    {
                        step: 1,
                        product: 'La Roche-Posay Toleriane Hydrating Gentle Cleanser',
                        type: 'Cleanser',
                        ingredients: ['Ceramides', 'Niacinamide', 'Glycerin'],
                        purpose: 'Gentle cleansing without stripping natural oils',
                        application: 'Massage for 30 seconds with cool water, pat dry - never rub',
                        priority: 'high',
                        timing: 'Daily in morning'
                    },
                    {
                        step: 2,
                        product: 'The Ordinary Hyaluronic Acid 2% + B5',
                        type: 'Hydrating Serum',
                        ingredients: ['Hyaluronic Acid', 'Vitamin B5'],
                        purpose: 'Intense hydration and moisture retention',
                        application: 'Apply to damp skin, press into face - do not rub',
                        priority: 'high',
                        timing: 'Daily on damp skin'
                    },
                    {
                        step: 3,
                        product: 'COSRX Advanced Snail 96 Mucin Power Essence',
                        type: 'Essence',
                        ingredients: ['Snail Secretion Filtrate 96%'],
                        purpose: 'Repair and hydrate with snail mucin benefits',
                        application: 'Pat into skin after serum, wait 1 minute to absorb',
                        priority: 'medium',
                        timing: 'Daily after serum'
                    },
                    {
                        step: 4,
                        product: 'Kiehl\'s Ultra Facial Cream',
                        type: 'Moisturizer',
                        ingredients: ['Squalane', 'Glacial Glycoprotein', 'Glycerin'],
                        purpose: '24-hour hydration without heaviness or greasy feel',
                        application: 'Apply generous amount to face and neck, massage gently',
                        priority: 'high',
                        timing: 'Daily after treatments'
                    },
                    {
                        step: 5,
                        product: 'La Roche-Posay Anthelios Melt-in Milk Sunscreen SPF 60',
                        type: 'Sunscreen',
                        ingredients: ['SPF 60', 'Mexoryl XL', 'Glycerin'],
                        purpose: 'High protection with hydrating base for dry skin',
                        application: 'Apply as final step, reapply every 2 hours if outdoors',
                        priority: 'high',
                        timing: 'Final morning step'
                    }
                ],
                eveningRoutine: [
                    {
                        step: 1,
                        product: 'The Ordinary Squalane Cleanser',
                        type: 'Oil Cleanser',
                        ingredients: ['Squalane', 'Ethyl Linoleate'],
                        purpose: 'First cleanse to remove makeup and sunscreen gently',
                        application: 'Massage dry skin for 60 seconds, then emulsify with water',
                        priority: 'high',
                        timing: 'Nightly first step'
                    },
                    {
                        step: 2,
                        product: 'CeraVe Hydrating Cream-to-Foam Cleanser',
                        type: 'Second Cleanser',
                        ingredients: ['Ceramides', 'Hyaluronic Acid'],
                        purpose: 'Second cleanse without stripping moisture',
                        application: 'Follow oil cleanse, rinse thoroughly with cool water',
                        priority: 'high',
                        timing: 'Nightly second step'
                    },
                    {
                        step: 3,
                        product: 'The Ordinary "Buffet" + Copper Peptides 1%',
                        type: 'Treatment Serum',
                        ingredients: ['Copper Peptides', 'Multiple Peptides', 'Hyaluronic Acid'],
                        purpose: 'Advanced anti-aging and barrier repair overnight',
                        application: 'Apply 1-2 droppers to face and neck, avoid other actives',
                        priority: 'medium',
                        timing: 'Nightly after cleansing'
                    },
                    {
                        step: 4,
                        product: 'Skinfix Barrier+ Triple Lipid-Peptide Cream',
                        type: 'Night Cream',
                        ingredients: ['Peptides', 'Ceramides', 'Fatty Acids'],
                        purpose: 'Intensive overnight barrier repair and nourishment',
                        application: 'Apply thick layer as final step, focus on dry areas',
                        priority: 'high',
                        timing: 'Final nightly step'
                    }
                ],
                keyIngredients: ['Hyaluronic Acid', 'Ceramides', 'Squalane', 'Peptides', 'Snail Mucin'],
                avoidIngredients: ['Alcohol', 'Fragrance', 'Strong exfoliants', 'Foaming cleansers', 'Hot water'],
                expertTips: [
                    'Apply moisturizer to damp skin for better absorption and hydration',
                    'Use lukewarm water instead of hot when cleansing to prevent moisture loss',
                    'Add a humidifier to your bedroom at night to combat dry air',
                    'Avoid over-exfoliating - focus on barrier repair first before any exfoliation',
                    'Drink 8-10 glasses of water daily to support skin hydration from within',
                    'Use gentle patting motions instead of rubbing when applying products'
                ],
                expectedResults: 'Improved hydration within 1 week, significant barrier repair in 2-4 weeks, reduced flakiness and tightness in 3-6 weeks'
            },

            'Oily Skin': {
                description: 'Excess sebum production and enlarged pores detected. Focus on oil control while maintaining hydration balance.',
                primaryConcerns: ['Excess oil', 'Enlarged pores', 'Shine', 'Frequent breakouts', 'Makeup fading'],
                severityLevel: 'Medium Priority',
                morningRoutine: [
                    {
                        step: 1,
                        product: 'CeraVe Foaming Facial Cleanser',
                        type: 'Cleanser',
                        ingredients: ['Niacinamide', 'Ceramides', 'Hyaluronic Acid'],
                        purpose: 'Remove excess oil without over-drying or stripping',
                        application: 'Focus massage on T-zone for 45 seconds, rinse thoroughly',
                        priority: 'high',
                        timing: 'Daily in morning'
                    },
                    {
                        step: 2,
                        product: 'The Ordinary Niacinamide 10% + Zinc 1%',
                        type: 'Treatment Serum',
                        ingredients: ['Niacinamide 10%', 'Zinc PCA 1%'],
                        purpose: 'Control sebum production and minimize pore appearance',
                        application: 'Apply to entire face, focus on oily T-zone areas',
                        priority: 'high',
                        timing: 'Daily after cleansing'
                    },
                    {
                        step: 3,
                        product: 'La Roche-Posay Effaclar Mat Oil-Free Moisturizer',
                        type: 'Moisturizer',
                        ingredients: ['Sebulyse Technology', 'Airlicium'],
                        purpose: 'Mattifying hydration with pore refinement',
                        application: 'Apply thin layer to entire face, avoid heavy application',
                        priority: 'medium',
                        timing: 'Daily after serum'
                    },
                    {
                        step: 4,
                        product: 'Supergoop! Unseen Sunscreen SPF 40',
                        type: 'Sunscreen',
                        ingredients: ['SPF 40', 'Red Algae', 'Frankincense'],
                        purpose: 'Weightless, invisible protection that controls shine',
                        application: 'Apply as final step, perfect base under makeup',
                        priority: 'high',
                        timing: 'Final morning step'
                    }
                ],
                eveningRoutine: [
                    {
                        step: 1,
                        product: 'The Inkey List Oat Cleansing Balm',
                        type: 'First Cleanser',
                        ingredients: ['Oat Kernel Oil', 'Squalane'],
                        purpose: 'Gentle makeup and sunscreen removal without clogging',
                        application: 'Massage dry skin, then emulsify with warm water',
                        priority: 'high',
                        timing: 'Nightly first step'
                    },
                    {
                        step: 2,
                        product: 'Paula\'s Choice Pore Normalizing Cleanser',
                        type: 'Second Cleanser',
                        ingredients: ['Ceramides', 'Chamomile', 'Green Tea'],
                        purpose: 'Deep clean pores and balance oil production',
                        application: 'Follow balm cleanse, focus on pore areas',
                        priority: 'high',
                        timing: 'Nightly second step'
                    },
                    {
                        step: 3,
                        product: 'The Ordinary Salicylic Acid 2% Masque',
                        type: 'Treatment (2x weekly)',
                        ingredients: ['Salicylic Acid 2%', 'Charcoal', 'Clay'],
                        purpose: 'Deep pore cleansing and oil control',
                        application: 'Apply 1-2x weekly for 10 minutes, then rinse',
                        priority: 'medium',
                        timing: 'Tuesday and Friday nights'
                    },
                    {
                        step: 4,
                        product: 'Kiehl\'s Midnight Recovery Concentrate',
                        type: 'Treatment Oil',
                        ingredients: ['Squalane', 'Evening Primrose Oil', 'Lavender'],
                        purpose: 'Balance oil production overnight with lightweight oils',
                        application: '3-4 drops pressed into skin, avoid heavy creams',
                        priority: 'low',
                        timing: 'Nightly final step'
                    }
                ],
                keyIngredients: ['Niacinamide', 'Salicylic Acid', 'Zinc', 'Clay', 'Squalane'],
                avoidIngredients: ['Heavy oils', 'Comedogenic ingredients', 'Alcohol-based products', 'Thick creams'],
                expertTips: [
                    'Use blotting papers throughout the day instead of washing frequently',
                    'Avoid over-washing as it can stimulate more oil production',
                    'Choose gel-based or water-based products over heavy creams',
                    'Clay masks 1-2 times per week can help control excess oil',
                    'Always remove makeup completely before bed to prevent clogged pores',
                    'Use oil-free makeup and skincare products labeled "non-comedogenic"'
                ],
                expectedResults: 'Reduced shine within 1 week, smaller appearing pores in 2-4 weeks, balanced oil production in 4-6 weeks'
            },

            'Normal Skin': {
                description: 'Well-balanced skin with minimal concerns detected. Focus on maintenance, prevention, and enhancement.',
                primaryConcerns: ['Maintenance', 'Prevention', 'Enhancement', 'Aging prevention'],
                severityLevel: 'Low Priority - Maintenance',
                morningRoutine: [
                    {
                        step: 1,
                        product: 'Kiehl\'s Ultra Facial Cleanser',
                        type: 'Cleanser',
                        ingredients: ['Squalane', 'Avocado Oil', 'Vitamin E'],
                        purpose: 'Gentle cleansing while maintaining natural balance',
                        application: 'Massage for 30 seconds, rinse well with lukewarm water',
                        priority: 'medium',
                        timing: 'Daily in morning'
                    },
                    {
                        step: 2,
                        product: 'The Ordinary "Buffet"',
                        type: 'Multi-Technology Serum',
                        ingredients: ['Multiple Peptides', 'Amino Acids', 'Hyaluronic Acid'],
                        purpose: 'Comprehensive anti-aging and hydration maintenance',
                        application: 'Apply 1 dropper to face and neck, let absorb 1 minute',
                        priority: 'medium',
                        timing: 'Daily after cleansing'
                    },
                    {
                        step: 3,
                        product: 'Kiehl\'s Ultra Facial Cream',
                        type: 'Moisturizer',
                        ingredients: ['Squalane', 'Glacial Glycoprotein'],
                        purpose: 'Lightweight 24-hour hydration maintenance',
                        application: 'Apply even layer to face and neck',
                        priority: 'medium',
                        timing: 'Daily after serum'
                    },
                    {
                        step: 4,
                        product: 'La Roche-Posay Anthelios Mineral Sunscreen SPF 50',
                        type: 'Sunscreen',
                        ingredients: ['SPF 50', '100% Mineral Filters', 'Cell-Ox Shield'],
                        purpose: 'Daily broad-spectrum protection for prevention',
                        application: 'Apply as final step, reapply every 2 hours in sun',
                        priority: 'high',
                        timing: 'Final morning step'
                    }
                ],
                eveningRoutine: [
                    {
                        step: 1,
                        product: 'The Ordinary Squalane Cleanser',
                        type: 'First Cleanser',
                        ingredients: ['Squalane', 'Lipid Compounds'],
                        purpose: 'Thorough makeup and sunscreen removal',
                        application: 'Massage dry, then emulsify with water',
                        priority: 'medium',
                        timing: 'Nightly first step'
                    },
                    {
                        step: 2,
                        product: 'CeraVe Hydrating Facial Cleanser',
                        type: 'Second Cleanser',
                        ingredients: ['Ceramides', 'Hyaluronic Acid'],
                        purpose: 'Gentle second cleanse to maintain balance',
                        application: 'Follow oil cleanse, rinse thoroughly',
                        priority: 'medium',
                        timing: 'Nightly second step'
                    },
                    {
                        step: 3,
                        product: 'The Ordinary Granactive Retinoid 2% Emulsion',
                        type: 'Treatment (3-4x weekly)',
                        ingredients: ['Hydroxypinacolone Retinoate', 'Coconut Alkanes'],
                        purpose: 'Advanced anti-aging and skin renewal',
                        application: 'Apply 3-4x weekly, build up tolerance gradually',
                        priority: 'medium',
                        timing: 'Monday, Wednesday, Friday, Sunday'
                    },
                    {
                        step: 4,
                        product: 'Skinfix Barrier+ Triple Lipid-Peptide Cream',
                        type: 'Night Cream',
                        ingredients: ['Peptides', 'Ceramides', 'Fatty Acids'],
                        purpose: 'Overnight repair and nourishment maintenance',
                        application: 'Apply as final step on retinoid nights',
                        priority: 'medium',
                        timing: 'Nightly final step'
                    }
                ],
                keyIngredients: ['Peptides', 'Retinoids', 'Antioxidants', 'Ceramides', 'Hyaluronic Acid'],
                avoidIngredients: ['Over-exfoliation', 'Harsh ingredients', 'Unnecessary products', 'Product overload'],
                expertTips: [
                    'Maintain your current healthy routine - consistency is most important',
                    'Focus on prevention with daily SPF and antioxidant protection',
                    'Don\'t over-complicate your routine with too many products',
                    'Regular professional facials can help maintain optimal skin health',
                    'Get adequate sleep and manage stress for overall skin health',
                    'Stay hydrated and maintain balanced diet for skin support'
                ],
                expectedResults: 'Maintained skin health, prevention of aging signs, enhanced radiance and texture with consistent care'
            }
        };

        // Tab switching function
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.currentTarget.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
        }

        // DEMO FUNCTION TO SHOW RESULTS IMMEDIATELY
        function showDemoResults() {
            const skinTypes = ['Acne-Prone Skin', 'Dry Skin', 'Oily Skin', 'Normal Skin'];
            const randomSkinType = skinTypes[Math.floor(Math.random() * skinTypes.length)];
            displayRealResults(randomSkinType, 0.95);
        }

        function loadProductList() {
            const conditionData = skinConditions[currentSkinType];
            let html = `
                <h3 style="margin-bottom: 20px; color: #2c3e50;">üõí Complete Product Catalog</h3>
                <div style="display: grid; gap: 15px;">
            `;
            
            const allProducts = [...conditionData.morningRoutine, ...conditionData.eveningRoutine];
            
            allProducts.forEach(product => {
                html += `
                    <div class="product-card">
                        <div class="product-name">${product.product}</div>
                        <div style="color: #7f8c8d; margin-bottom: 10px;">${product.type} ‚Ä¢ ${product.timing}</div>
                        <div style="margin-bottom: 10px;">
                            <strong>Purpose:</strong> ${product.purpose}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Key Ingredients:</strong>
                            ${product.ingredients.map(ing => `<span class="ingredient-tag">${ing}</span>`).join('')}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Application:</strong> ${product.application}
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                            <span class="priority-badge priority-${product.priority}">${product.priority.toUpperCase()} PRIORITY</span>
                            <span style="color: #27ae60; font-weight: 600;">${product.timing}</span>
                        </div>
                    </div>
                `;
            });
            
            // Add weekly treatments if they exist
            if (conditionData.weeklyTreatments && conditionData.weeklyTreatments.length > 0) {
                html += `<h4 style="margin: 25px 0 15px 0; color: #2c3e50;">üìÜ Weekly Treatments</h4>`;
                conditionData.weeklyTreatments.forEach(treatment => {
                    html += `
                        <div class="product-card">
                            <div class="product-name">${treatment.product}</div>
                            <div style="color: #7f8c8d; margin-bottom: 10px;">${treatment.frequency}</div>
                            <div style="margin-bottom: 10px;">
                                <strong>Purpose:</strong> ${treatment.purpose}
                            </div>
                            <div style="margin-bottom: 10px;">
                                <strong>Application:</strong> ${treatment.application}
                            </div>
                            ${treatment.warning ? `<div style="color: #e74c3c; font-weight: 600; margin-top: 10px;">‚ö†Ô∏è ${treatment.warning}</div>` : ''}
                        </div>
                    `;
                });
            }
            
            html += `</div>`;
            document.getElementById('product-list').innerHTML = html;
        }

        function loadExpertTips() {
            const conditionData = skinConditions[currentSkinType];
            let html = `
                <h3 style="margin-bottom: 20px; color: #2c3e50;">üí° Professional Advice & Guidelines</h3>
                <div style="display: grid; gap: 15px;">
            `;
            
            conditionData.expertTips.forEach((tip, index) => {
                html += `
                    <div class="product-card">
                        <div style="display: flex; align-items: start; gap: 15px;">
                            <div style="background: #3498db; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0;">${index + 1}</div>
                            <div style="font-size: 1em; line-height: 1.5;">${tip}</div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                <div class="confidence-meter">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">üéØ Key Ingredients to Look For</h4>
                    <div style="margin: 15px 0;">
                        ${conditionData.keyIngredients.map(ing => `<span class="ingredient-tag">${ing}</span>`).join('')}
                    </div>
                    <p style="color: #7f8c8d; margin: 10px 0 0 0;">These ingredients are scientifically proven to address your specific skin concerns</p>
                </div>

                <div class="confidence-meter" style="border-left-color: #e74c3c;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">üö´ Ingredients to Avoid</h4>
                    <p style="color: #7f8c8d; margin: 0;">${conditionData.avoidIngredients.join(', ')}</p>
                    <p style="color: #e74c3c; margin: 10px 0 0 0; font-weight: 600;">These can exacerbate your skin concerns or cause irritation</p>
                </div>

                <div class="confidence-meter" style="border-left-color: #f39c12;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">üìÖ Expected Results Timeline</h4>
                    <p style="color: #7f8c8d; margin: 0; font-size: 1.1em;">${conditionData.expectedResults}</p>
                </div>
            `;
            
            document.getElementById('expert-tips').innerHTML = html;
        }

        // Start camera function
        async function startCamera() {
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');
            const videoElement = document.getElementById('webcam-video');
            const placeholder = document.getElementById('camera-placeholder');

            try {
                loadingElement.innerHTML = 'üî¨ Initializing camera...';
                startBtn.disabled = true;

                // Setup webcam
                loadingElement.innerHTML = 'üì∑ Accessing camera...';
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { width: 450, height: 337, facingMode: 'user' } 
                });

                videoElement.srcObject = stream;
                videoElement.classList.remove('hidden');
                placeholder.classList.add('hidden');

                loadingElement.innerHTML = '‚úÖ Camera ready! Click "Analyze Skin" to begin';
                startBtn.classList.add('hidden');
                stopBtn.classList.remove('hidden');
                analyzeBtn.disabled = false;
                isCameraOn = true;

            } catch (error) {
                loadingElement.innerHTML = '‚ùå Camera access denied. Click "Show Demo Results" to see how it works.';
                startBtn.disabled = false;
            }
        }

        // Stop camera function
        function stopCamera() {
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const videoElement = document.getElementById('webcam-video');
            const placeholder = document.getElementById('camera-placeholder');
            const loadingElement = document.getElementById('loading');

            if (isAnalyzing) stopAnalysis();
            if (videoElement.srcObject) {
                videoElement.srcObject.getTracks().forEach(track => track.stop());
                videoElement.srcObject = null;
            }

            videoElement.classList.add('hidden');
            placeholder.classList.remove('hidden');
            startBtn.classList.remove('hidden');
            stopBtn.classList.add('hidden');
            analyzeBtn.disabled = true;
            loadingElement.innerHTML = '';
            isCameraOn = false;
        }

        // Analyze skin function - SIMULATED FOR DEMO
        function analyzeSkin() {
            if (!isCameraOn) return;

            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');

            analyzeBtn.disabled = true;
            isAnalyzing = true;
            loadingElement.innerHTML = 'üî¨ AI is analyzing your skin...';

            // Simulate AI analysis
            setTimeout(() => {
                const skinTypes = ['Acne-Prone Skin', 'Dry Skin', 'Oily Skin', 'Normal Skin'];
                const randomSkinType = skinTypes[Math.floor(Math.random() * skinTypes.length)];
                const randomConfidence = (0.85 + Math.random() * 0.1).toFixed(2);
                
                displayRealResults(randomSkinType, randomConfidence);
                stopAnalysis();
            }, 3000);

            analyzeBtn.innerHTML = '‚èπÔ∏è Stop Analysis';
            analyzeBtn.onclick = stopAnalysis;
        }

        // Stop analysis function
        function stopAnalysis() {
            isAnalyzing = false;
            if (analysisInterval) {
                clearInterval(analysisInterval);
                analysisInterval = null;
            }
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');
            analyzeBtn.innerHTML = 'üîç Analyze Skin';
            analyzeBtn.onclick = analyzeSkin;
        }

        // Display results function - GUARANTEED TO WORK
        function displayRealResults(skinType, confidence) {
            console.log('Displaying results for:', skinType);
            currentSkinType = skinType;
            const conditionData = skinConditions[skinType];
            const confidencePercent = (confidence * 100).toFixed(1);
            
            // Show results section
            document.getElementById('results-section').classList.remove('hidden');
            
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <div class="skin-type-badge">${skinType}</div>
                    <div class="confidence-meter">
                        <h3 style="margin: 0 0 10px 0; color: #2c3e50;">AI Confidence: ${confidencePercent}%</h3>
                        <p style="margin: 0; color: #7f8c8d; font-size: 1.1em;">${conditionData.description}</p>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 25px 0;">
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.08);">
                        <div style="font-size: 2em; margin-bottom: 10px;">üéØ</div>
                        <div style="font-weight: 600; color: #2c3e50;">Primary Concerns</div>
                        <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">${conditionData.primaryConcerns.join(', ')}</div>
                    </div>
                    <div style="background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 3px 10px rgba(0,0,0,0.08);">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚ö°</div>
                        <div style="font-weight: 600; color: #2c3e50;">Severity Level</div>
                        <div style="color: #7f8c8d; font-size: 0.9em; margin-top: 5px;">${conditionData.severityLevel}</div>
                    </div>
                </div>
            `;

            // Load all tabs
            loadRoutineRecommendations();
            loadProductList();
            loadExpertTips();
            
            // Scroll to results
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        function loadRoutineRecommendations() {
            const conditionData = skinConditions[currentSkinType];
            let html = `
                <div style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px; color: #2c3e50;">üåÖ Morning Routine</h3>
            `;
            
            conditionData.morningRoutine.forEach(step => {
                html += `
                    <div class="routine-step">
                        <div class="step-header">
                            <div class="step-number">${step.step}</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; font-size: 1.1em; color: #2c3e50;">${step.product}</div>
                                <div style="color: #7f8c8d; font-size: 0.9em;">${step.type} ‚Ä¢ ${step.timing}</div>
                            </div>
                            <span class="priority-badge priority-${step.priority}">${step.priority.toUpperCase()}</span>
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Purpose:</strong> ${step.purpose}
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Key Ingredients:</strong>
                            ${step.ingredients.map(ing => `<span class="ingredient-tag">${ing}</span>`).join('')}
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Application:</strong> ${step.application}
                        </div>
                    </div>
                `;
            });
            
            html += `</div><div><h3 style="margin-bottom: 20px; color: #2c3e50;">üåô Evening Routine</h3>`;
            
            conditionData.eveningRoutine.forEach(step => {
                html += `
                    <div class="routine-step">
                        <div class="step-header">
                            <div class="step-number">${step.step}</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; font-size: 1.1em; color: #2c3e50;">${step.product}</div>
                                <div style="color: #7f8c8d; font-size: 0.9em;">${step.type} ‚Ä¢ ${step.timing}</div>
                            </div>
                            <span class="priority-badge priority-${step.priority}">${step.priority.toUpperCase()}</span>
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Purpose:</strong> ${step.purpose}
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Key Ingredients:</strong>
                            ${step.ingredients.map(ing => `<span class="ingredient-tag">${ing}</span>`).join('')}
                        </div>
                        <div style="margin: 10px 0;">
                            <strong>Application:</strong> ${step.application}
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            document.getElementById('recommendations').innerHTML = html;
        }

        function startNewAnalysis() {
            document.getElementById('results-section').classList.add('hidden');
            stopCamera();
        }

        function shareApp() {
            const shareUrl = 'https://allyguuu.github.io/skin-ai/';
            if (navigator.clipboard) {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert('üìã Link copied to clipboard! Share your personalized skincare routine with friends.');
                });
            } else {
                alert('Share this link: ' + shareUrl);
            }
        }

        // Initial welcome message
        window.onload = function() {
            console.log('GlowGuide AI loaded successfully!');
        };
    </script>
</body>
</html>
