<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlowGuide AI - Real AI Skin Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        .header {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ffa8a8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .camera-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        #video-container {
            position: relative;
            display: inline-block;
            margin: 10px 0;
        }
        #defaultCanvas0 {
            border: 3px solid white;
            border-radius: 10px;
            background: black;
        }
        .buttons {
            margin: 20px 0;
        }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        button:hover {
            background: #ff5252;
            transform: scale(1.05);
        }
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        .secondary-btn {
            background: #4CAF50;
        }
        .secondary-btn:hover {
            background: #45a049;
        }
        .result-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        .product {
            background: white;
            color: #333;
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
        }
        .skin-type {
            display: inline-block;
            padding: 8px 20px;
            background: #ff6b6b;
            border-radius: 20px;
            margin: 10px 0;
            font-weight: bold;
        }
        .confidence-display {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .disclaimer {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 30px;
        }
        .loading {
            font-size: 18px;
            margin: 20px 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }
        .user-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .prediction-display {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            min-height: 60px;
        }
        .camera-feed {
            border: 3px solid white;
            border-radius: 10px;
            background: black;
            width: 400px;
            height: 300px;
            object-fit: cover;
        }
    </style>
    
    <!-- p5.js and ml5.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/addons/p5.dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ml5/1.0.0/ml5.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ú® GlowGuide AI ‚ú®</h1>
            <p>Real AI Skin Analysis & Personalized Recommendations</p>
            <div class="user-count">
                <strong>üöÄ Powered by p5.js + ml5.js Neural Network</strong>
            </div>
        </div>

        <div class="feature-grid">
            <div class="feature">
                <h3>üß† Real AI</h3>
                <p>ml5.js neural network</p>
            </div>
            <div class="feature">
                <h3>üíé Personalized</h3>
                <p>Custom recommendations</p>
            </div>
            <div class="feature">
                <h3>üéØ Live Analysis</h3>
                <p>Real-time detection</p>
            </div>
            <div class="feature">
                <h3>üîí Private</h3>
                <p>No data stored</p>
            </div>
        </div>

        <div class="camera-box">
            <h3>üì∑ AI Skin Analysis</h3>
            <div id="video-container">
                <!-- Camera will appear here -->
            </div>
            <div class="prediction-display" id="prediction-display">
                <p>Click "Start AI Analysis" to begin</p>
            </div>
            <div class="buttons">
                <button onclick="startCamera()" id="startBtn">üé• Start AI Analysis</button>
                <button onclick="shareApp()" class="secondary-btn">üì§ Share This App</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <!-- Loading messages will appear here -->
        </div>

        <div id="result"></div>
        <div id="recommendations"></div>

        <div class="result-box">
            <h3>üí° Tips for Best AI Results</h3>
            <ul style="text-align: left; margin: 15px;">
                <li>Use good lighting facing your face</li>
                <li>Remove makeup for accurate analysis</li>
                <li>Take photo in natural light if possible</li>
                <li>Keep face centered in frame</li>
                <li>Stay still during analysis for best accuracy</li>
            </ul>
        </div>

        <p class="disclaimer">
            ‚ö†Ô∏è Disclaimer: This AI provides cosmetic recommendations only. Not medical advice. 
            Consult a dermatologist for serious concerns. We don't store your images.
        </p>
    </div>

    <script>
        // Global variables
        let classifier;
        let video;
        let isModelLoaded = false;
        let isCameraActive = false;

        // REPLACE THIS WITH YOUR ACTUAL MODEL URL from Teachable Machine
        let imageModelURL = 'https://teachablemachine.withgoogle.com/models/YOUR_MODEL_ID/';

        // Skin analysis database
        const skinConditions = {
            'Acne Skin': {
                description: 'AI detected signs of breakouts, redness, and inflammation.',
                symptoms: ['Pimples', 'Blackheads', 'Redness', 'Oily T-zone', 'Inflammation'],
                products: [
                    'CeraVe SA Cleanser - With Salicylic Acid to unclog pores',
                    'The Ordinary Niacinamide 10% + Zinc 1% - Reduces inflammation and oil',
                    'La Roche-Posay Effaclar Duo - Targets acne and post-acne marks',
                    'Neutrogena Oil-Free Acne Wash - Daily prevention wash'
                ],
                routine: 'üîÑ Cleanse twice daily ‚Üí üß¥ Apply serum ‚Üí üíß Oil-free moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Avoid touching your face throughout the day',
                    'Change pillowcases weekly',
                    'Use non-comedogenic products only'
                ]
            },
            'Dry Skin': {
                description: 'AI detected signs of flakiness, tightness, and dehydration.',
                symptoms: ['Flaky patches', 'Tight feeling', 'Rough texture', 'Redness', 'Itching'],
                products: [
                    'La Roche-Posay Lipikar Moisturizer - Intense 24h hydration',
                    'The Ordinary Hyaluronic Acid - Attracts and holds moisture',
                    'CeraVe Moisturizing Cream - Repairs skin barrier',
                    'Kiehl\'s Ultra Facial Cream - Non-greasy hydration'
                ],
                routine: 'üîÑ Gentle cleanser ‚Üí üí¶ Hydrating serum ‚Üí üß¥ Rich moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Apply moisturizer to damp skin',
                    'Use lukewarm water instead of hot',
                    'Add a humidifier to your room'
                ]
            },
            'Oily Skin': {
                description: 'AI detected excess sebum production and shiny appearance.',
                symptoms: ['Shiny appearance', 'Large pores', 'Greasy feel', 'Frequent breakouts'],
                products: [
                    'Neutrogena Oil-Free Cleanser - Removes excess oil',
                    'The Ordinary Salicylic Acid - Deep cleans pores',
                    'La Roche-Posay Matte Moisturizer - Oil-free hydration',
                    'Biore Charcoal Cleanser - Deep cleans oily areas'
                ],
                routine: 'üîÑ Oil-control cleanser ‚Üí üéØ Treatment ‚Üí üíß Oil-free moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Use blotting papers throughout the day',
                    'Avoid over-washing',
                    'Choose gel-based products'
                ]
            },
            'Normal Skin': {
                description: 'AI detected balanced, healthy skin with few concerns.',
                symptoms: ['Even tone', 'Smooth texture', 'Few breakouts', 'Comfortable feel'],
                products: [
                    'Cetaphil Gentle Cleanser - Maintains skin balance',
                    'The Ordinary "Buffet" - Multi-target serum',
                    'Kiehl\'s Ultra Facial Cream - Lightweight hydration',
                    'La Roche-Posay Toleriane - Maintains skin health'
                ],
                routine: 'üîÑ Gentle cleanse ‚Üí üíé Serum ‚Üí üíß Moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Maintain your current routine',
                    'Focus on prevention',
                    'Regular sunscreen is key'
                ]
            }
        };

        // Start camera and AI analysis
        async function startCamera() {
            const startBtn = document.getElementById('startBtn');
            const loadingElement = document.getElementById('loading');
            const predictionDisplay = document.getElementById('prediction-display');
            
            startBtn.disabled = true;
            startBtn.innerHTML = 'üîÑ Starting Camera...';
            loadingElement.innerHTML = 'üî¨ Accessing camera...';
            
            try {
                // Initialize p5.js sketch
                const sketch = function(p) {
                    p.setup = function() {
                        // Create canvas for video
                        const canvas = p.createCanvas(400, 300);
                        canvas.parent('video-container');
                        
                        // Create video capture
                        video = p.createCapture(p.VIDEO);
                        video.size(400, 300);
                        video.hide(); // Hide the default video element
                        
                        loadingElement.innerHTML = 'üéØ Camera active! Loading AI model...';
                        
                        // Load the AI model
                        classifier = ml5.imageClassifier(imageModelURL + 'model.json', function() {
                            loadingElement.innerHTML = '‚úÖ AI Model Loaded! Analyzing your skin...';
                            startBtn.innerHTML = '‚úÖ AI Analysis Active';
                            isModelLoaded = true;
                            isCameraActive = true;
                            
                            // Start classification
                            classifyVideo();
                        });
                    };

                    p.draw = function() {
                        p.background(0);
                        // Draw the flipped video (mirror effect)
                        p.translate(p.width, 0);
                        p.scale(-1, 1);
                        p.image(video, 0, 0, p.width, p.height);
                    };
                };

                // Create p5 instance
                new p5(sketch);

            } catch (error) {
                console.error('Camera error:', error);
                loadingElement.innerHTML = '‚ùå Camera error. Please allow camera access and refresh.';
                startBtn.disabled = false;
                startBtn.innerHTML = 'üé• Try Again';
            }
        }

        // Classify video frames
        function classifyVideo() {
            if (!classifier || !video) return;
            
            // Get current video frame and flip it
            const flippedVideo = ml5.flipImage(video);
            
            // Classify the image
            classifier.classify(flippedVideo, gotResult);
            
            // Clean up
            flippedVideo.remove();
        }

        // Handle classification results
        function gotResult(error, results) {
            if (error) {
                console.error('Classification error:', error);
                return;
            }
            
            if (results && results[0]) {
                const label = results[0].label;
                const confidence = results[0].confidence;
                const confidencePercent = (confidence * 100).toFixed(1);
                
                // Update prediction display
                const predictionDisplay = document.getElementById('prediction-display');
                predictionDisplay.innerHTML = `
                    <h4>üéØ Live AI Detection:</h4>
                    <div class="confidence-display">
                        <strong>${label}</strong><br>
                        <span>Confidence: ${confidencePercent}%</span>
                    </div>
                `;
                
                // Update main results if confidence is high enough
                if (confidence > 0.6) {
                    displayRealResults(label, confidence);
                }
                
                // Continue classifying (creates a loop)
                if (isCameraActive) {
                    setTimeout(classifyVideo, 1000); // Classify every second
                }
            }
        }

        // Display AI analysis results
        function displayRealResults(skinType, confidence) {
            const conditionData = skinConditions[skinType] || skinConditions['Normal Skin'];
            const confidencePercent = (confidence * 100).toFixed(1);
            
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = `
                <div class="result-box">
                    <h2>üéØ AI Skin Analysis Complete!</h2>
                    <div class="skin-type">${skinType}</div>
                    <p><strong>AI Confidence:</strong> ${confidencePercent}%</p>
                    <p><strong>Description:</strong> ${conditionData.description}</p>
                    <p><strong>Detected Signs:</strong> ${conditionData.symptoms.join(', ')}</p>
                    
                    <h3 style="margin-top: 20px;">üìã Your Custom Routine</h3>
                    <p>${conditionData.routine}</p>
                    
                    <h3 style="margin-top: 20px;">üí° Expert Tips</h3>
                    <ul style="margin: 10px 0 10px 20px;">
                        ${conditionData.tips.map(tip => `<li>${tip}</li>`).join('')}
                    </ul>
                </div>
            `;

            showRecommendations(skinType);
        }

        // Show product recommendations
        function showRecommendations(skinType) {
            const conditionData = skinConditions[skinType] || skinConditions['Normal Skin'];
            const products = conditionData.products;
            
            let productsHTML = `
                <div class="result-box">
                    <h3>üíé Recommended Products for ${skinType}</h3>
                    <p>These products work well for your skin type:</p>
            `;
            
            products.forEach(product => {
                productsHTML += `
                    <div class="product">
                        <strong>${product.split(' - ')[0]}</strong><br>
                        <em>${product.split(' - ')[1]}</em>
                    </div>
                `;
            `;
            
            productsHTML += `
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px;">
                    <strong>üí° Tip:</strong> Available at most beauty stores and online retailers.
                </div>
            </div>
            `;
            
            document.getElementById('recommendations').innerHTML = productsHTML;
        }

        // Share function
        function shareApp() {
            const shareUrl = 'https://allyguuu.github.io/skin-ai/';
            if (navigator.clipboard) {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert('üìã Link copied to clipboard! Share: ' + shareUrl);
                });
            } else {
                alert('Share this link: ' + shareUrl);
            }
        }

        // Initial welcome message
        window.onload = function() {
            document.getElementById('result').innerHTML = `
                <div class="result-box">
                    <h3>üëã Welcome to GlowGuide AI!</h3>
                    <p>Get real-time AI skin analysis using your camera.</p>
                    <p><strong>Click "Start AI Analysis" to begin! üöÄ</strong></p>
                </div>
            `;
        };
    </script>
</body>
</html>
