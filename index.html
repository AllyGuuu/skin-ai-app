<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlowGuide AI - Real AI Skin Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        .header {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #ffa8a8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .camera-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        #video-container {
            position: relative;
            display: inline-block;
            margin: 10px 0;
        }
        #webcam-video {
            border: 3px solid white;
            border-radius: 10px;
            background: black;
            width: 400px;
            height: 300px;
            object-fit: cover;
            transform: scaleX(-1);
        }
        .camera-placeholder {
            width: 400px;
            height: 300px;
            border: 3px solid white;
            border-radius: 10px;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        .buttons {
            margin: 20px 0;
        }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        button:hover {
            background: #ff5252;
            transform: scale(1.05);
        }
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        .secondary-btn {
            background: #4CAF50;
        }
        .secondary-btn:hover {
            background: #45a049;
        }
        .stop-btn {
            background: #ff4757;
        }
        .stop-btn:hover {
            background: #ff3742;
        }
        .result-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        .product {
            background: white;
            color: #333;
            margin: 10px 0;
            padding: 15px;
            border-radius: 10px;
        }
        .skin-type {
            display: inline-block;
            padding: 8px 20px;
            background: #ff6b6b;
            border-radius: 20px;
            margin: 10px 0;
            font-weight: bold;
        }
        .confidence-display {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .disclaimer {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 30px;
        }
        .loading {
            font-size: 18px;
            margin: 20px 0;
            min-height: 30px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .feature {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }
        .user-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .prediction-display {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            min-height: 60px;
        }
        .hidden {
            display: none;
        }
        .success-message {
            background: rgba(76, 175, 80, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ú® GlowGuide AI ‚ú®</h1>
            <p>Real AI Skin Analysis & Personalized Recommendations</p>
            <div class="user-count">
                <strong>üöÄ Powered by Real AI - Model Ready!</strong>
            </div>
        </div>

        <div class="success-message">
            <h3>‚úÖ AI Model Connected!</h3>
            <p>Your personal skin analysis AI is ready to use. Click "Start Camera" below!</p>
        </div>

        <div class="feature-grid">
            <div class="feature">
                <h3>üß† Real AI</h3>
                <p>Trained neural network</p>
            </div>
            <div class="feature">
                <h3>üíé Personalized</h3>
                <p>Custom recommendations</p>
            </div>
            <div class="feature">
                <h3>üéØ Live Analysis</h3>
                <p>Real-time detection</p>
            </div>
            <div class="feature">
                <h3>üîí Private</h3>
                <p>No data stored</p>
            </div>
        </div>

        <div class="camera-box">
            <h3>üì∑ AI Skin Analysis</h3>
            
            <div id="video-container">
                <div id="camera-placeholder" class="camera-placeholder">
                    <p>Camera will appear here</p>
                </div>
                <video id="webcam-video" class="hidden" autoplay playsinline></video>
            </div>
            
            <div class="prediction-display" id="prediction-display">
                <p>Click "Start Camera" to begin analysis</p>
            </div>
            
            <div class="buttons">
                <button onclick="startCamera()" id="startBtn">üé• Start Camera</button>
                <button onclick="stopCamera()" id="stopBtn" class="stop-btn hidden">‚èπÔ∏è Stop Camera</button>
                <button onclick="analyzeSkin()" id="analyzeBtn" disabled>üîç Analyze Skin</button>
                <button onclick="shareApp()" class="secondary-btn">üì§ Share App</button>
            </div>
        </div>

        <div class="loading" id="loading"></div>

        <div id="result"></div>
        <div id="recommendations"></div>

        <div class="result-box">
            <h3>üí° Tips for Best AI Results</h3>
            <ul style="text-align: left; margin: 15px;">
                <li>Use good lighting facing your face</li>
                <li>Remove makeup for accurate analysis</li>
                <li>Take photo in natural light if possible</li>
                <li>Keep face centered in frame</li>
                <li>Stay still during analysis for best accuracy</li>
            </ul>
        </div>

        <p class="disclaimer">
            ‚ö†Ô∏è Disclaimer: This AI provides cosmetic recommendations only. Not medical advice. 
            Consult a dermatologist for serious concerns. We don't store your images.
        </p>
    </div>

    <!-- TensorFlow.js and Teachable Machine -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <script>
        // Global variables
        let model;
        let webcam;
        let isCameraOn = false;
        let isAnalyzing = false;
        let analysisInterval;

        // ‚úÖ YOUR ACTUAL MODEL URL - Ready to use!
        const modelURL = 'https://teachablemachine.withgoogle.com/models/XmgPTvPSp/model.json';
        const metadataURL = 'https://teachablemachine.withgoogle.com/models/XmgPTvPSp/metadata.json';

        // Skin analysis database - Make sure these match your model's class names
        const skinConditions = {
            'Acne Skin': {
                description: 'AI detected signs of breakouts, redness, and inflammation.',
                symptoms: ['Pimples', 'Blackheads', 'Redness', 'Oily T-zone', 'Inflammation'],
                products: [
                    'CeraVe SA Cleanser - With Salicylic Acid to unclog pores',
                    'The Ordinary Niacinamide 10% + Zinc 1% - Reduces inflammation and oil',
                    'La Roche-Posay Effaclar Duo - Targets acne and post-acne marks',
                    'Neutrogena Oil-Free Acne Wash - Daily prevention wash'
                ],
                routine: 'üîÑ Cleanse twice daily ‚Üí üß¥ Apply serum ‚Üí üíß Oil-free moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Avoid touching your face throughout the day',
                    'Change pillowcases weekly',
                    'Use non-comedogenic products only'
                ]
            },
            'Dry Skin': {
                description: 'AI detected signs of flakiness, tightness, and dehydration.',
                symptoms: ['Flaky patches', 'Tight feeling', 'Rough texture', 'Redness', 'Itching'],
                products: [
                    'La Roche-Posay Lipikar Moisturizer - Intense 24h hydration',
                    'The Ordinary Hyaluronic Acid - Attracts and holds moisture',
                    'CeraVe Moisturizing Cream - Repairs skin barrier',
                    'Kiehl\'s Ultra Facial Cream - Non-greasy hydration'
                ],
                routine: 'üîÑ Gentle cleanser ‚Üí üí¶ Hydrating serum ‚Üí üß¥ Rich moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Apply moisturizer to damp skin',
                    'Use lukewarm water instead of hot',
                    'Add a humidifier to your room'
                ]
            },
            'Oily Skin': {
                description: 'AI detected excess sebum production and shiny appearance.',
                symptoms: ['Shiny appearance', 'Large pores', 'Greasy feel', 'Frequent breakouts'],
                products: [
                    'Neutrogena Oil-Free Cleanser - Removes excess oil',
                    'The Ordinary Salicylic Acid - Deep cleans pores',
                    'La Roche-Posay Matte Moisturizer - Oil-free hydration',
                    'Biore Charcoal Cleanser - Deep cleans oily areas'
                ],
                routine: 'üîÑ Oil-control cleanser ‚Üí üéØ Treatment ‚Üí üíß Oil-free moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Use blotting papers throughout the day',
                    'Avoid over-washing',
                    'Choose gel-based products'
                ]
            },
            'Normal Skin': {
                description: 'AI detected balanced, healthy skin with few concerns.',
                symptoms: ['Even tone', 'Smooth texture', 'Few breakouts', 'Comfortable feel'],
                products: [
                    'Cetaphil Gentle Cleanser - Maintains skin balance',
                    'The Ordinary "Buffet" - Multi-target serum',
                    'Kiehl\'s Ultra Facial Cream - Lightweight hydration',
                    'La Roche-Posay Toleriane - Maintains skin health'
                ],
                routine: 'üîÑ Gentle cleanse ‚Üí üíé Serum ‚Üí üíß Moisturizer ‚Üí üõ°Ô∏è Sunscreen',
                tips: [
                    'Maintain your current routine',
                    'Focus on prevention',
                    'Regular sunscreen is key'
                ]
            }
        };

        // Start camera
        async function startCamera() {
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');
            const videoElement = document.getElementById('webcam-video');
            const placeholder = document.getElementById('camera-placeholder');

            try {
                loadingElement.innerHTML = 'üî¨ Starting camera...';
                startBtn.disabled = true;

                // Load AI model first
                if (!model) {
                    loadingElement.innerHTML = 'üß† Loading AI model...';
                    model = await tmImage.load(modelURL, metadataURL);
                    loadingElement.innerHTML = '‚úÖ AI model loaded!';
                }

                // Setup webcam
                loadingElement.innerHTML = 'üì∑ Accessing camera...';
                
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: 400, 
                        height: 300,
                        facingMode: 'user' 
                    } 
                });

                // Show video element
                videoElement.srcObject = stream;
                videoElement.classList.remove('hidden');
                placeholder.classList.add('hidden');

                // Initialize webcam for Teachable Machine
                webcam = new tmImage.Webcam(400, 300, true);
                await webcam.setup();
                await webcam.play();

                // Update UI
                loadingElement.innerHTML = '‚úÖ Camera ready! Click "Analyze Skin"';
                startBtn.classList.add('hidden');
                stopBtn.classList.remove('hidden');
                analyzeBtn.disabled = false;
                isCameraOn = true;

            } catch (error) {
                console.error('Camera error:', error);
                loadingElement.innerHTML = '‚ùå ' + error.message;
                startBtn.disabled = false;
                
                if (error.name === 'NotAllowedError') {
                    loadingElement.innerHTML = '‚ùå Camera permission denied. Please allow camera access and refresh.';
                }
            }
        }

        // Stop camera
        function stopCamera() {
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const videoElement = document.getElementById('webcam-video');
            const placeholder = document.getElementById('camera-placeholder');
            const loadingElement = document.getElementById('loading');

            // Stop analysis if running
            if (isAnalyzing) {
                stopAnalysis();
            }

            // Stop camera stream
            if (videoElement.srcObject) {
                const tracks = videoElement.srcObject.getTracks();
                tracks.forEach(track => track.stop());
                videoElement.srcObject = null;
            }

            // Stop Teachable Machine webcam
            if (webcam) {
                webcam.stop();
                webcam = null;
            }

            // Update UI
            videoElement.classList.add('hidden');
            placeholder.classList.remove('hidden');
            startBtn.classList.remove('hidden');
            stopBtn.classList.add('hidden');
            analyzeBtn.disabled = true;
            loadingElement.innerHTML = '';
            
            isCameraOn = false;
        }

        // Analyze skin
        async function analyzeSkin() {
            if (!isCameraOn || !model || !webcam) {
                alert('Please start the camera first!');
                return;
            }

            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');

            analyzeBtn.disabled = true;
            isAnalyzing = true;
            loadingElement.innerHTML = 'üî¨ AI is analyzing your skin...';

            // Start continuous analysis
            analysisInterval = setInterval(async () => {
                if (!isAnalyzing) return;

                try {
                    const predictions = await model.predict(webcam.canvas);
                    updatePredictions(predictions);
                } catch (error) {
                    console.error('Analysis error:', error);
                }
            }, 2000);

            // Add stop analysis button
            analyzeBtn.innerHTML = '‚èπÔ∏è Stop Analysis';
            analyzeBtn.onclick = stopAnalysis;
            analyzeBtn.disabled = false;
        }

        // Stop analysis
        function stopAnalysis() {
            isAnalyzing = false;
            
            if (analysisInterval) {
                clearInterval(analysisInterval);
                analysisInterval = null;
            }

            const analyzeBtn = document.getElementById('analyzeBtn');
            const loadingElement = document.getElementById('loading');

            analyzeBtn.innerHTML = 'üîç Analyze Skin';
            analyzeBtn.onclick = analyzeSkin;
            loadingElement.innerHTML = '‚úÖ Analysis stopped';
        }

        // Update predictions display
        function updatePredictions(predictions) {
            const predictionDisplay = document.getElementById('prediction-display');
            let highestProb = 0;
            let mainLabel = '';

            let predictionsHTML = '<h4>üéØ Live AI Analysis:</h4>';
            
            predictions.forEach(prediction => {
                const percent = (prediction.probability * 100).toFixed(1);
                predictionsHTML += `
                    <div class="confidence-display">
                        <strong>${prediction.className}:</strong> ${percent}%
                    </div>
                `;

                if (prediction.probability > highestProb) {
                    highestProb = prediction.probability;
                    mainLabel = prediction.className;
                }
            });

            predictionDisplay.innerHTML = predictionsHTML;

            // Show detailed results if confidence is high
            if (highestProb > 0.7) {
                displayRealResults(mainLabel, highestProb);
            }
        }

        // Display AI analysis results
        function displayRealResults(skinType, confidence) {
            const conditionData = skinConditions[skinType] || skinConditions['Normal Skin'];
            const confidencePercent = (confidence * 100).toFixed(1);
            
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = `
                <div class="result-box">
                    <h2>üéØ AI Skin Analysis Complete!</h2>
                    <div class="skin-type">${skinType}</div>
                    <p><strong>AI Confidence:</strong> ${confidencePercent}%</p>
                    <p><strong>Description:</strong> ${conditionData.description}</p>
                    <p><strong>Detected Signs:</strong> ${conditionData.symptoms.join(', ')}</p>
                    
                    <h3 style="margin-top: 20px;">üìã Your Custom Routine</h3>
                    <p>${conditionData.routine}</p>
                    
                    <h3 style="margin-top: 20px;">üí° Expert Tips</h3>
                    <ul style="margin: 10px 0 10px 20px;">
                        ${conditionData.tips.map(tip => `<li>${tip}</li>`).join('')}
                    </ul>
                    
                    <p style="margin-top: 15px; background: rgba(100,255,100,0.2); padding: 10px; border-radius: 5px;">
                        ‚úÖ <strong>Real AI Analysis:</strong> Powered by your trained neural network!
                    </p>
                </div>
            `;

            showRecommendations(skinType);
        }

        // Show product recommendations
        function showRecommendations(skinType) {
            const conditionData = skinConditions[skinType] || skinConditions['Normal Skin'];
            const products = conditionData.products;
            
            let productsHTML = `
                <div class="result-box">
                    <h3>üíé Recommended Products for ${skinType}</h3>
                    <p>These products work well for your skin type:</p>
            `;
            
            products.forEach(product => {
                productsHTML += `
                    <div class="product">
                        <strong>${product.split(' - ')[0]}</strong><br>
                        <em>${product.split(' - ')[1]}</em>
                    </div>
                `;
            });
            
            productsHTML += `
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.2); border-radius: 10px;">
                    <strong>üõí Where to buy:</strong> Available at Amazon, Sephora, Ulta, or your local pharmacy.
                </div>
            </div>
            `;
            
            document.getElementById('recommendations').innerHTML = productsHTML;
        }

        // Share function
        function shareApp() {
            const shareUrl = 'https://allyguuu.github.io/skin-ai/';
            const shareText = 'Check out this amazing AI skin analysis app! It uses real neural networks to analyze your skin.';
            
            if (navigator.share) {
                navigator.share({
                    title: 'GlowGuide AI - Real AI Skin Analysis',
                    text: shareText,
                    url: shareUrl
                });
            } else {
                navigator.clipboard.writeText(shareUrl).then(() => {
                    alert('üìã Link copied to clipboard! Share: ' + shareUrl);
                });
            }
        }

        // Clean up when page closes
        window.addEventListener('beforeunload', () => {
            stopCamera();
        });

        // Initial welcome message
        window.onload = function() {
            document.getElementById('result').innerHTML = `
                <div class="result-box">
                    <h3>üëã Welcome to GlowGuide AI!</h3>
                    <p>This app uses <strong>real AI powered by your trained neural network</strong> to analyze your skin and provide personalized recommendations.</p>
                    
                    <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4>üéØ How It Works:</h4>
                        <ul style="text-align: left; margin: 10px;">
                            <li>Click <strong>"Start Camera"</strong> to load the neural network</li>
                            <li>Allow camera access when prompted</li>
                            <li>Position your face clearly in the frame</li>
                            <li>Click <strong>"Analyze Skin"</strong> for real-time AI analysis</li>
                            <li>Get personalized product recommendations</li>
                        </ul>
                    </div>
                    
                    <p><strong>Ready to discover what AI says about your skin? Click "Start Camera"! üöÄ</strong></p>
                </div>
            `;
        };
    </script>
</body>
</html>
